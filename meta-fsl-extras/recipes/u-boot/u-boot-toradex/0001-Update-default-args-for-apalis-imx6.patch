From 4569a8b4997340aae34365f2f896b842f8cc114b Mon Sep 17 00:00:00 2001
From: Samuli Piippo <samuli.piippo@digia.com>
Date: Mon, 27 Oct 2014 14:53:25 +0200
Subject: [PATCH] Update default args for apalis imx6

Boot from sd card by default
---
 include/configs/apalis_imx6.h | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

diff --git a/include/configs/apalis_imx6.h b/include/configs/apalis_imx6.h
index 3ea4a5c..53d9a0c 100644
--- a/include/configs/apalis_imx6.h
+++ b/include/configs/apalis_imx6.h
@@ -252,14 +252,14 @@
 		"&& setenv dtbparam \" - ${fdt_addr_r}\" && true\0"
 
 #define SD_BOOTCMD						\
-	"sdargs=ip=off root=/dev/mmcblk1p2 rw,noatime rootfstype=ext3 " \
-		"rootwait\0" \
+	"drive=2\0" \
 	"sdboot=run setup; " \
-		"setenv bootargs ${defargs} ${sdargs} ${setupargs} " \
+		"setenv bootargs ${defargs} ip=off root=/dev/mmcblk${drive}p2 " \
+		"rw,noatime rootfstype=ext3 rootwait ${setupargs} " \
 		"${vidargs}; echo Booting from SD card in 8-bit slot...; " \
-		"run sddtbload; load mmc 1:1 ${kernel_addr_r} " \
+		"run sddtbload; load mmc ${drive}:1 ${kernel_addr_r} " \
 		"${boot_file} && bootm ${kernel_addr_r} ${dtbparam}\0" \
-	"sddtbload=setenv dtbparam; load mmc 1:1 ${fdt_addr_r} " \
+	"sddtbload=setenv dtbparam; load mmc ${drive}:1 ${fdt_addr_r} " \
 		"${fdt_file} && setenv dtbparam \" - ${fdt_addr_r}\" && true\0"
 
 #define USB_BOOTCMD \
@@ -279,7 +279,8 @@
 #define FDT_FILE "imx6q-apalis_v1_0-eval.dtb"
 #endif
 #define CONFIG_EXTRA_ENV_SETTINGS \
-	"bootcmd=run emmcboot ; echo ; echo emmcboot failed ; " \
+	"bootcmd=run sdboot ; echo ; echo sdboot failed ; " \
+		"run emmcboot ; echo ; echo emmcboot failed ; " \
 		"run nfsboot ; echo ; echo nfsboot failed ; " \
 		"usb start ;" \
 		"setenv stdout serial,vga ; setenv stdin serial,usbkbd\0" \
-- 
1.9.1

